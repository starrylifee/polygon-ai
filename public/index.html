<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë‹¤ê°í˜• ë¯¸ìˆ  ì‹œê°„ ğŸ¨</title>
    <meta name="description" content="AI ì„ ìƒë‹˜ê³¼ í•¨ê»˜í•˜ëŠ” ì¬ë¯¸ìˆëŠ” ë‹¤ê°í˜• ë¯¸ìˆ  ì‹œê°„! ë„í˜•ì„ ì¡°í•©í•´ì„œ ì°½ì˜ì ì¸ ì‘í’ˆì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.">

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¨</text></svg>">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');

        body {
            font-family: 'Jua', sans-serif;
            background-color: #f8fafc;
            overflow: hidden;
            touch-action: none;
        }

        .canvas-bg {
            background-image:
                linear-gradient(to right, #cbd5e1 1px, transparent 1px),
                linear-gradient(to bottom, #cbd5e1 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .vertex-handle {
            cursor: pointer;
            transition: r 0.1s, fill 0.1s;
        }

        .vertex-handle:hover {
            r: 8;
            fill: #fbbf24;
        }

        .slide-up {
            animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const SHAPES_CONFIG = {
            3: { name: 'ì‚¼ê°í˜•', color: 'rgba(239, 68, 68, 0.8)', stroke: '#b91c1c' },
            4: { name: 'ì‚¬ê°í˜•', color: 'rgba(59, 130, 246, 0.8)', stroke: '#1d4ed8' },
            5: { name: 'ì˜¤ê°í˜•', color: 'rgba(16, 185, 129, 0.8)', stroke: '#047857' },
            6: { name: 'ìœ¡ê°í˜•', color: 'rgba(245, 158, 11, 0.8)', stroke: '#b45309' },
            7: { name: 'ì¹ ê°í˜•', color: 'rgba(139, 92, 246, 0.8)', stroke: '#6d28d9' },
            8: { name: 'íŒ”ê°í˜•', color: 'rgba(236, 72, 153, 0.8)', stroke: '#be185d' },
        };

        const ALL_MISSIONS = [
            // [ë‚œì´ë„ 2ê°œ] - ì‰¬ì›€
            { id: 101, theme: "ì§‘", icon: "ğŸ ", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 102, theme: "ëˆˆì‚¬ëŒ", icon: "â›„", requirements: { 8: 1, 6: 1 }, total: 2 },
            { id: 103, theme: "ë‚˜ë¬´", icon: "ğŸŒ³", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 104, theme: "ë¬¼ê³ ê¸°", icon: "ğŸŸ", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 105, theme: "ë²„ì„¯", icon: "ğŸ„", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 106, theme: "ë§ˆì´í¬", icon: "ğŸ¤", requirements: { 8: 1, 4: 1 }, total: 2 },
            { id: 107, theme: "ë³´ì„ë°˜ì§€", icon: "ğŸ’", requirements: { 5: 1, 8: 1 }, total: 2 },
            { id: 108, theme: "ì•„ì´ìŠ¤í¬ë¦¼", icon: "ğŸ¦", requirements: { 3: 1, 6: 1 }, total: 2 },
            { id: 109, theme: "ì—°", icon: "ğŸª", requirements: { 4: 1, 3: 1 }, total: 2 },
            { id: 110, theme: "í’ì„ ", icon: "ğŸˆ", requirements: { 6: 1, 4: 1 }, total: 2 },
            { id: 111, theme: "í™”ì‚´í‘œ", icon: "â¡ï¸", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 112, theme: "í•˜íŠ¸", icon: "â¤ï¸", requirements: { 3: 2 }, total: 2 },
            { id: 113, theme: "ë³„", icon: "â­", requirements: { 3: 2 }, total: 2 },
            { id: 114, theme: "ë°°", icon: "ğŸš¢", requirements: { 3: 1, 4: 1 }, total: 2 },
            { id: 115, theme: "í…íŠ¸", icon: "â›º", requirements: { 3: 1, 4: 1 }, total: 2 },

            // [ë‚œì´ë„ 3ê°œ] - ë³´í†µ
            { id: 201, theme: "ìš°ì£¼ì„ ", icon: "ğŸš€", requirements: { 3: 1, 4: 2 }, total: 3 },
            { id: 202, theme: "ì™•ê´€", icon: "ğŸ‘‘", requirements: { 3: 3 }, total: 3 },
            { id: 203, theme: "ì‚¬íƒ•", icon: "ğŸ¬", requirements: { 6: 1, 3: 2 }, total: 3 },
            { id: 204, theme: "ì˜¤ì§•ì–´", icon: "ğŸ¦‘", requirements: { 3: 1, 4: 2 }, total: 3 },
            { id: 205, theme: "ìš”íŠ¸", icon: "â›µ", requirements: { 4: 1, 3: 2 }, total: 3 },
            { id: 206, theme: "ì—¬ìš°", icon: "ğŸ¦Š", requirements: { 3: 2, 5: 1 }, total: 3 },
            { id: 207, theme: "ì¼€ì´í¬", icon: "ğŸ‚", requirements: { 4: 2, 3: 1 }, total: 3 },
            { id: 208, theme: "ê³ ì–‘ì´", icon: "ğŸ±", requirements: { 6: 1, 3: 2 }, total: 3 },
            { id: 209, theme: "ì„ ì¸ì¥", icon: "ğŸŒµ", requirements: { 4: 1, 6: 2 }, total: 3 },
            { id: 210, theme: "í”¼ì", icon: "ğŸ•", requirements: { 3: 3 }, total: 3 },
            { id: 211, theme: "ë¹„í–‰ê¸°", icon: "âœˆï¸", requirements: { 4: 1, 3: 2 }, total: 3 },
            { id: 212, theme: "í† ë¼", icon: "ğŸ°", requirements: { 6: 1, 4: 2 }, total: 3 },
            { id: 213, theme: "ì„ ë¬¼ìƒì", icon: "ğŸ", requirements: { 4: 2, 3: 1 }, total: 3 },
            { id: 214, theme: "í–„ë²„ê±°", icon: "ğŸ”", requirements: { 4: 2, 6: 1 }, total: 3 },
            { id: 215, theme: "ëˆˆê½ƒ", icon: "â„ï¸", requirements: { 6: 1, 3: 2 }, total: 3 },

            // [ë‚œì´ë„ 4ê°œ] - ì–´ë ¤ì›€
            { id: 301, theme: "ë‚˜ë¹„", icon: "ğŸ¦‹", requirements: { 3: 4 }, total: 4 },
            { id: 302, theme: "ìë™ì°¨", icon: "ğŸš—", requirements: { 4: 2, 8: 2 }, total: 4 },
            { id: 303, theme: "ì ìë¦¬", icon: "ğŸ¦Ÿ", requirements: { 6: 1, 4: 1, 3: 2 }, total: 4 },
            { id: 304, theme: "ê½ƒ", icon: "ğŸŒ¸", requirements: { 6: 1, 3: 3 }, total: 4 },
            { id: 305, theme: "ê°•ì•„ì§€", icon: "ğŸ¶", requirements: { 4: 1, 3: 2, 6: 1 }, total: 4 },
            { id: 306, theme: "í—¬ë¦¬ì½¥í„°", icon: "ğŸš", requirements: { 4: 2, 3: 2 }, total: 4 },
            { id: 307, theme: "ë¬´ì§€ê°œ", icon: "ğŸŒˆ", requirements: { 4: 4 }, total: 4 },
            { id: 308, theme: "í­ê·„", icon: "ğŸ§", requirements: { 6: 1, 4: 2, 3: 1 }, total: 4 },
            { id: 309, theme: "ì„ í’ê¸°", icon: "ğŸŒ€", requirements: { 8: 1, 3: 3 }, total: 4 },
            { id: 310, theme: "ìš°ì‚°", icon: "â˜‚ï¸", requirements: { 6: 1, 4: 1, 3: 2 }, total: 4 },
            { id: 311, theme: "íŠ¸ëŸ­", icon: "ğŸšš", requirements: { 4: 2, 8: 2 }, total: 4 },
            { id: 312, theme: "ê³°", icon: "ğŸ»", requirements: { 6: 2, 8: 2 }, total: 4 },
            { id: 313, theme: "í•´ë°”ë¼ê¸°", icon: "ğŸŒ»", requirements: { 8: 1, 4: 1, 3: 2 }, total: 4 },
            { id: 314, theme: "ìƒˆ", icon: "ğŸ¦", requirements: { 6: 1, 3: 3 }, total: 4 },
            { id: 315, theme: "ë¡œì¼“", icon: "ğŸš€", requirements: { 3: 2, 4: 2 }, total: 4 },

            // [ë‚œì´ë„ 5ê°œ] - ë„ì „
            { id: 401, theme: "ë¡œë´‡", icon: "ğŸ¤–", requirements: { 4: 3, 3: 2 }, total: 5 },
            { id: 402, theme: "ì„±", icon: "ğŸ°", requirements: { 4: 3, 3: 2 }, total: 5 },
            { id: 403, theme: "ê¸°ì°¨", icon: "ğŸš‚", requirements: { 4: 2, 8: 3 }, total: 5 },
            { id: 404, theme: "ê³µë£¡", icon: "ğŸ¦–", requirements: { 4: 2, 3: 3 }, total: 5 },
            { id: 405, theme: "ì‚¬ëŒ", icon: "ğŸ§", requirements: { 6: 1, 4: 2, 3: 2 }, total: 5 },
            { id: 406, theme: "í¬ë¦¬ìŠ¤ë§ˆìŠ¤íŠ¸ë¦¬", icon: "ğŸ„", requirements: { 3: 3, 4: 1, 8: 1 }, total: 5 },
            { id: 407, theme: "ë²„ìŠ¤", icon: "ğŸšŒ", requirements: { 4: 2, 8: 3 }, total: 5 },
            { id: 408, theme: "í’ì°¨", icon: "ğŸŒ¬ï¸", requirements: { 3: 4, 4: 1 }, total: 5 },
            { id: 409, theme: "í•´ì ì„ ", icon: "ğŸ´â€â˜ ï¸", requirements: { 4: 2, 3: 3 }, total: 5 },
            { id: 410, theme: "ë¶€ì—‰ì´", icon: "ğŸ¦‰", requirements: { 6: 2, 8: 2, 3: 1 }, total: 5 },
            { id: 411, theme: "ì†Œë°©ì°¨", icon: "ğŸš’", requirements: { 4: 3, 8: 2 }, total: 5 },
            { id: 412, theme: "UFO", icon: "ğŸ›¸", requirements: { 8: 2, 4: 2, 3: 1 }, total: 5 },
            { id: 413, theme: "ì•…ì–´", icon: "ğŸŠ", requirements: { 4: 3, 3: 2 }, total: 5 },
            { id: 414, theme: "ìì „ê±°", icon: "ğŸš²", requirements: { 8: 2, 3: 2, 4: 1 }, total: 5 },
            { id: 415, theme: "íƒ±í¬", icon: "ğŸª–", requirements: { 4: 3, 8: 2 }, total: 5 },
        ];

        const GRID_SIZE = 20;

        const App = () => {
            const [shapes, setShapes] = useState([]);
            const [mission, setMission] = useState(null);
            const [dragging, setDragging] = useState({ isDragging: false, target: null, type: null, vertexIndex: null, startX: 0, startY: 0, initialVertices: [] });
            const [aiStatus, setAiStatus] = useState('idle');
            const [aiFeedback, setAiFeedback] = useState("");
            const [score, setScore] = useState(0);
            const [level, setLevel] = useState('all');

            const svgRef = useRef(null);

            useEffect(() => {
                startNewMission();
            }, [level]);

            const snapToGrid = (value) => Math.round(value / GRID_SIZE) * GRID_SIZE;

            const createShape = (sides, idOffset = 0) => {
                const centerX = snapToGrid(window.innerWidth / 2 + (Math.random() - 0.5) * 200);
                const centerY = snapToGrid(window.innerHeight / 2 + (Math.random() - 0.5) * 150);
                const radius = 60;
                const vertices = [];
                for (let i = 0; i < sides; i++) {
                    const angle = (i * 2 * Math.PI) / sides - Math.PI / 2;
                    vertices.push({
                        x: snapToGrid(centerX + radius * Math.cos(angle)),
                        y: snapToGrid(centerY + radius * Math.sin(angle))
                    });
                }
                return {
                    id: Date.now() + Math.random() + idOffset,
                    sides,
                    vertices,
                    color: SHAPES_CONFIG[sides].color,
                    stroke: SHAPES_CONFIG[sides].stroke
                };
            };

            const startNewMission = () => {
                let availableMissions = ALL_MISSIONS;
                if (level !== 'all') {
                    availableMissions = ALL_MISSIONS.filter(m => m.total === level);
                }

                const randomMission = availableMissions[Math.floor(Math.random() * availableMissions.length)];
                setMission(randomMission);
                setAiStatus('idle');
                setAiFeedback("");
                setScore(0);

                const initialShapes = [];
                let idCounter = 0;
                Object.entries(randomMission.requirements).forEach(([sides, count]) => {
                    for (let i = 0; i < count; i++) {
                        initialShapes.push(createShape(parseInt(sides), idCounter++));
                    }
                });
                setShapes(initialShapes);
            };

            const getMousePosition = (evt) => {
                const CTM = svgRef.current.getScreenCTM();
                let clientX, clientY;
                if (evt.touches) { clientX = evt.touches[0].clientX; clientY = evt.touches[0].clientY; }
                else { clientX = evt.clientX; clientY = evt.clientY; }
                return { x: (clientX - CTM.e) / CTM.a, y: (clientY - CTM.f) / CTM.d };
            };

            const handleMouseDown = (evt, shapeId, type, vertexIndex = null) => {
                if (aiStatus === 'analyzing') return;
                evt.preventDefault();
                const pos = getMousePosition(evt);
                const targetShape = shapes.find(s => s.id === shapeId);
                setDragging({
                    isDragging: true, target: shapeId, type, vertexIndex, startX: pos.x, startY: pos.y,
                    initialVertices: JSON.parse(JSON.stringify(targetShape.vertices))
                });
            };

            const handleMouseMove = (evt) => {
                if (!dragging.isDragging) return;
                evt.preventDefault();
                const pos = getMousePosition(evt);
                const dx = pos.x - dragging.startX;
                const dy = pos.y - dragging.startY;

                setShapes(prev => prev.map(shape => {
                    if (shape.id !== dragging.target) return shape;
                    const newVertices = [...shape.vertices];

                    if (dragging.type === 'body') {
                        const snappedDx = snapToGrid(dx);
                        const snappedDy = snapToGrid(dy);
                        if (snappedDx === 0 && snappedDy === 0) return shape;
                        for (let i = 0; i < dragging.initialVertices.length; i++) {
                            newVertices[i] = {
                                x: dragging.initialVertices[i].x + snappedDx,
                                y: dragging.initialVertices[i].y + snappedDy
                            };
                        }
                    } else if (dragging.type === 'vertex') {
                        const targetInitV = dragging.initialVertices[dragging.vertexIndex];
                        const snappedX = snapToGrid(targetInitV.x + dx);
                        const snappedY = snapToGrid(targetInitV.y + dy);

                        const prevIdx = (dragging.vertexIndex - 1 + newVertices.length) % newVertices.length;
                        const nextIdx = (dragging.vertexIndex + 1) % newVertices.length;
                        const prevV = newVertices[prevIdx];
                        const nextV = newVertices[nextIdx];
                        const area = Math.abs(prevV.x * (snappedY - nextV.y) + snappedX * (nextV.y - prevV.y) + nextV.x * (prevV.y - snappedY));
                        if (area < 10) return shape;

                        newVertices[dragging.vertexIndex] = { x: snappedX, y: snappedY };
                    }
                    return { ...shape, vertices: newVertices };
                }));
            };

            const handleMouseUp = () => setDragging(prev => ({ ...prev, isDragging: false }));

            const captureCanvas = async () => {
                const svg = svgRef.current;
                const serializer = new XMLSerializer();
                const svgString = serializer.serializeToString(svg);

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const svgRect = svg.getBoundingClientRect();

                canvas.width = svgRect.width;
                canvas.height = svgRect.height;

                ctx.fillStyle = "#ffffff";
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                return new Promise((resolve) => {
                    const img = new Image();
                    const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });
                    const url = URL.createObjectURL(svgBlob);

                    img.onload = () => {
                        ctx.drawImage(img, 0, 0);
                        URL.revokeObjectURL(url);
                        resolve(canvas.toDataURL('image/png').split(',')[1]);
                    };
                    img.src = url;
                });
            };

            const checkAnswerWithAI = async () => {
                if (shapes.length === 0) return;
                setAiStatus('analyzing');
                setAiFeedback("AIê°€ ì‘í’ˆì„ ê°ìƒí•˜ê³  ìˆì–´ìš”... ğŸ§");
                setScore(0);

                try {
                    const base64Image = await captureCanvas();

                    // Vercel Serverless Function í˜¸ì¶œ
                    const response = await fetch('/api/evaluate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            image: base64Image,
                            mission: {
                                theme: mission.theme,
                                icon: mission.icon,
                                requirements: mission.requirements
                            }
                        })
                    });

                    if (!response.ok) {
                        throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                    }

                    const result = await response.json();

                    setScore(result.score);
                    setAiFeedback(result.message);
                    setAiStatus(result.isCorrect ? 'success' : 'fail');

                } catch (error) {
                    console.error("AI Error:", error);
                    setAiFeedback("AI ì„ ìƒë‹˜ì´ ì ì‹œ ì‰¬ëŠ” ì‹œê°„ì´ë„¤ìš”. ë‹¤ì‹œ ë¶ˆëŸ¬ì£¼ì„¸ìš”!");
                    setAiStatus('fail');
                    setScore(0);
                }
            };

            return (
                <div className="flex flex-col h-screen w-full relative select-none bg-slate-50">

                    <header className="bg-white p-2 md:p-4 shadow-sm z-10 flex flex-col md:flex-row justify-between items-center gap-2 md:h-20">
                        <div className="flex items-center gap-4 w-full md:w-auto justify-between">
                            <h1 className="text-xl md:text-2xl font-bold text-gray-800 flex items-center gap-2 shrink-0">
                                <span className="text-green-500">AI</span> ëˆˆì°ë¯¸ ë¯¸ìˆ  ì‹œê°„ ğŸ¨
                            </h1>
                            <div className="flex bg-gray-100 rounded-lg p-1 gap-1">
                                {['all', 2, 3, 4, 5].map(lvl => (
                                    <button
                                        key={lvl}
                                        onClick={() => setLevel(lvl)}
                                        className={`px-3 py-1 rounded-md text-sm font-bold transition
                                            ${level === lvl
                                                ? 'bg-white text-green-600 shadow-sm'
                                                : 'text-gray-400 hover:text-gray-600'
                                            }`}
                                    >
                                        {lvl === 'all' ? 'ëœë¤' : `${lvl}ê°œ`}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {mission && (
                            <div className="flex flex-col items-end w-full md:w-auto">
                                <div className="text-lg font-bold text-slate-700 flex items-center gap-2 bg-white px-3 py-1 rounded-full border shadow-sm justify-center w-full md:w-auto">
                                    ë¯¸ì…˜: <span className="text-2xl">{mission.icon}</span> {mission.theme}
                                </div>
                            </div>
                        )}
                    </header>

                    <div className="flex-1 relative overflow-hidden canvas-bg">
                        <div className="absolute top-4 left-4 bg-white/80 backdrop-blur p-3 rounded-xl border border-slate-200 shadow-sm z-10 hidden md:block">
                            <h3 className="text-xs font-bold text-slate-500 mb-2">í•„ìš”í•œ ì¬ë£Œ ({mission?.total}ê°œ)</h3>
                            <div className="flex flex-col gap-2">
                                {mission && Object.entries(mission.requirements).map(([sides, count]) => (
                                    <div key={sides} className="flex items-center gap-2 text-sm text-slate-700">
                                        <div className="w-3 h-3 rounded-full" style={{ backgroundColor: SHAPES_CONFIG[sides].stroke }}></div>
                                        {SHAPES_CONFIG[sides].name} {count}ê°œ
                                    </div>
                                ))}
                            </div>
                        </div>

                        <svg
                            ref={svgRef}
                            className="w-full h-full cursor-crosshair touch-none"
                            onMouseMove={handleMouseMove}
                            onTouchMove={handleMouseMove}
                            onMouseUp={handleMouseUp}
                            onTouchEnd={handleMouseUp}
                            onMouseLeave={handleMouseUp}
                        >
                            {shapes.map((shape) => (
                                <g key={shape.id}>
                                    <polygon
                                        points={shape.vertices.map(v => `${v.x},${v.y}`).join(' ')}
                                        fill={shape.color}
                                        stroke={shape.stroke}
                                        strokeWidth="3"
                                        onMouseDown={(e) => handleMouseDown(e, shape.id, 'body')}
                                        onTouchStart={(e) => handleMouseDown(e, shape.id, 'body')}
                                        style={{ cursor: 'move' }}
                                    />
                                    {shape.vertices.map((vertex, idx) => (
                                        <circle
                                            key={idx}
                                            cx={vertex.x}
                                            cy={vertex.y}
                                            r="6"
                                            fill="white"
                                            stroke={shape.stroke}
                                            strokeWidth="2"
                                            className="vertex-handle"
                                            onMouseDown={(e) => { e.stopPropagation(); handleMouseDown(e, shape.id, 'vertex', idx); }}
                                            onTouchStart={(e) => { e.stopPropagation(); handleMouseDown(e, shape.id, 'vertex', idx); }}
                                        />
                                    ))}
                                </g>
                            ))}
                        </svg>

                        {aiStatus !== 'idle' && (
                            <div className="absolute bottom-24 left-1/2 transform -translate-x-1/2 w-11/12 max-w-lg z-50 pointer-events-none">
                                <div className={`
                                    slide-up bg-white shadow-2xl rounded-2xl p-5 border-2 text-center pointer-events-auto
                                    ${aiStatus === 'analyzing' ? 'border-blue-200' : ''}
                                    ${aiStatus === 'success' ? 'border-green-500 ring-4 ring-green-100' : ''}
                                    ${aiStatus === 'fail' ? 'border-orange-400 ring-4 ring-orange-50' : ''}
                                `}>
                                    <div className="flex flex-col items-center gap-3">
                                        {aiStatus === 'analyzing' && (
                                            <div className="flex flex-col items-center">
                                                <div className="animate-spin text-3xl mb-2">ğŸ¤”</div>
                                                <p className="text-slate-600 font-bold">ìŒ... ì–´ë–¤ ì‘í’ˆì¼ê¹Œìš”?</p>
                                            </div>
                                        )}

                                        {aiStatus !== 'analyzing' && (
                                            <>
                                                <div className="flex items-center justify-center gap-2 mb-1">
                                                    <span className="text-4xl">
                                                        {aiStatus === 'success' ? 'ğŸ¥³' : 'ğŸ§'}
                                                    </span>
                                                    <span className={`text-3xl font-black ${aiStatus === 'success' ? 'text-green-600' : 'text-orange-500'}`}>
                                                        {score}ì 
                                                    </span>
                                                </div>

                                                <div className="bg-slate-50 p-3 rounded-xl w-full text-slate-800 font-medium whitespace-pre-wrap leading-relaxed border border-slate-100 break-keep">
                                                    {aiFeedback}
                                                </div>

                                                <button
                                                    onClick={() => {
                                                        if (aiStatus === 'success') startNewMission();
                                                        else setAiStatus('idle');
                                                    }}
                                                    className={`
                                                        mt-2 w-full py-3 rounded-xl font-bold text-white shadow-md transition transform active:scale-95
                                                        ${aiStatus === 'success' ? 'bg-green-500 hover:bg-green-600' : 'bg-orange-400 hover:bg-orange-500'}
                                                    `}
                                                >
                                                    {aiStatus === 'success' ? 'ì¢‹ì•„ìš”! ë‹¤ìŒ ë¯¸ì…˜! ğŸš€' : 'ë‹¤ì‹œ ê³ ì³ë³¼ê²Œìš” ğŸ’ª'}
                                                </button>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="bg-white p-4 border-t border-gray-100 z-10 flex flex-col shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
                        <div className="flex justify-center gap-4 h-16 items-center">
                            <button
                                onClick={startNewMission}
                                disabled={aiStatus === 'analyzing'}
                                className="px-6 py-3 bg-gray-100 text-gray-500 rounded-full font-bold hover:bg-gray-200 transition disabled:opacity-50 text-sm"
                            >
                                ë‹¤ë¥¸ ì£¼ì œ
                            </button>

                            <button
                                onClick={checkAnswerWithAI}
                                disabled={aiStatus === 'analyzing' || shapes.length === 0}
                                className={`
                                    flex-1 max-w-xs py-3 rounded-full font-bold text-white shadow-lg transition flex items-center justify-center gap-2
                                    ${aiStatus === 'analyzing'
                                        ? 'bg-gray-400 cursor-wait'
                                        : 'bg-gradient-to-r from-blue-500 to-teal-500 hover:from-blue-600 hover:to-teal-600 hover:-translate-y-1'}
                                `}
                            >
                                {aiStatus === 'analyzing' ? 'ê°ìƒ ì¤‘...' : 'ğŸ“¸ AI ì„ ìƒë‹˜! ë³´ì„¸ìš”!'}
                            </button>
                        </div>
                        <div className="text-center text-xs text-gray-400 pb-1">
                            Â© ì„œìš¸ì‹ ë‹µì´ˆë“±í•™êµ ì •ìš©ì„
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>